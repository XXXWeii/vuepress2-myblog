import{h as r,defineComponent as m,ref as p,computed as d,nextTick as T,onMounted as h}from"vue";import{l as V}from"../../FadeSlideY-afecc946.js";import{usePageFrontmatter as w,usePageData as O}from"@vuepress/client";import{IconBase as _,keys as H,startsWith as I}from"vuepress-shared/client";import{a as M,b as x}from"../../themeData-ed37366d.js";import{useStorage as E,useSessionStorage as g}from"@vueuse/core";import{compareSync as f}from"bcrypt-ts/browser";import{isPlainObject as G}from"@vuepress/shared";import"@vuepress/plugin-theme-data/client";const b=()=>r(_,{name:"lock"},()=>r("path",{d:"M787.168 952.268H236.832c-30.395 0-55.033-24.638-55.033-55.033V429.45c0-30.395 24.638-55.034 55.033-55.034h82.55V264.35c0-106.38 86.238-192.618 192.618-192.618S704.618 157.97 704.618 264.35v110.066h82.55c30.395 0 55.033 24.639 55.033 55.034v467.785c0 30.395-24.639 55.033-55.033 55.033zM484.483 672.046v115.122h55.034V672.046c31.99-11.373 55.033-41.605 55.033-77.496 0-45.592-36.958-82.55-82.55-82.55s-82.55 36.958-82.55 82.55c0 35.89 23.042 66.123 55.033 77.496zM622.067 264.35c0-60.788-49.28-110.067-110.067-110.067s-110.067 49.28-110.067 110.067v110.066h220.135V264.35z"}));b.displayName="LockIcon";var k=m({name:"PasswordModal",props:{full:Boolean},emits:["verify"],setup(o,{emit:e}){const n=w(),s=M(),u=p(""),a=p(!1),l=p(!1),t=d(()=>s.value.encryptLocales);let c=null;const v=()=>{c&&clearTimeout(c),a.value=!1,e("verify",u.value,l.value),T().then(()=>{a.value=!0,c=setTimeout(()=>{a.value=!1},1e3)})};return()=>r("div",{class:["password-layer",{expand:o.full||n.value.home}]},r("div",{class:"password-modal"},[r("div",{class:["hint",{tried:a.value}]},a.value?t.value.errorHint:r(b,{"aria-label":t.value.iconLabel})),r("div",{class:"password"},[r("input",{type:"password",value:u.value,placeholder:t.value.placeholder,onInput:({target:i})=>{u.value=i.value},onKeydown:({key:i})=>{i==="Enter"&&v()}})]),r("div",{class:"remember-password"},[r("input",{type:"checkbox",value:l.value,onChange:()=>l.value=!l.value}),t.value.remember]),r("button",{class:"submit",onClick:()=>v()},"OK")]))}});const P=()=>{const o=x();return d(()=>o.value.encrypt||{})},S="VUEPRESS_HOPE_GLOBAL_TOKEN",K=()=>{const o=P(),e=E(S,""),n=g(S,""),s=d(()=>{const{global:a=!1,admin:l=[]}=o.value;return a&&l.length>0}),u=d(()=>{if(s.value){if(e.value)return o.value.admin.some(a=>f(e.value,a));if(n.value)return o.value.admin.some(a=>f(n.value,a))}return!1});return{isEncrypted:s,isDecrypted:u,validate:(a,l=!1)=>{(l?e:n).value=a}}},y=(o="",e)=>!!o&&f(o,e),D="VUEPRESS_HOPE_PATH_TOKEN",z=()=>{const o=O(),e=P(),n=E(D,{}),s=g(D,{}),u=l=>G(e.value.config)?H(e.value.config).filter(t=>I(decodeURI(l),t)).sort((t,c)=>c.length-t.length):[],a=l=>{const t=u(l);if(t.length>0){const{config:c={}}=e.value;return{isEncrypted:!0,isDecrypted:t.some(v=>n.value[v]&&c[v].some(i=>y(n.value[v],i))||s.value[v]&&c[v].some(i=>y(s.value[v],i)))}}return{isDecrypted:!1,isEncrypted:!1}};return{status:d(()=>a(o.value.path)),getStatus:a,validate:(l,t=!1)=>{const{config:c={}}=e.value,v=u(o.value.path);for(const i of v)if(c[i].filter(L=>y(l,L))){(t?n:s).value[i]=l;break}}}};var B=m({name:"GlobalEncrypt",setup(o,{slots:e}){const{isDecrypted:n,isEncrypted:s,validate:u}=K(),a=p(!1);return h(()=>{a.value=!0}),()=>r(V,()=>{var l,t;return s.value?a.value?n.value?(l=e.default)==null?void 0:l.call(e):r(k,{full:!0,onVerify:u}):null:(t=e.default)==null?void 0:t.call(e)})}}),C=m({name:"LocalEncrypt",setup(o,{slots:e}){const{status:n,validate:s}=z(),u=p(!1);return h(()=>{u.value=!0}),()=>{var a,l;const{isEncrypted:t,isDecrypted:c}=n.value;return t?u.value?c?((a=e.default)==null?void 0:a.call(e))||null:r(k,{full:!0,onVerify:s}):null:((l=e.default)==null?void 0:l.call(e))||null}}});export{B as GlobalEncrypt,C as LocalEncrypt};
//# sourceMappingURL=export.js.map
